<!-- Mobile menu template -->
<ng-template #mobileNavigationTemplate let-navigation>
    <ul *ngIf="navigation?.length">
        <li *ngFor="let item of navigation" [class.opened]="item.opened">
            <a [routerLink]="item.link" matRipple *ngIf="!item.children?.length" (click)="menu.close()">{{ item.display }}</a>
            <a (click)="item.opened = !item.opened;" matRipple *ngIf="item.children?.length">{{ item.display }}</a>
            <ng-container *ngTemplateOutlet="mobileNavigationTemplate; context:{ $implicit: item.children }"></ng-container>
        </li>
    </ul>
</ng-template>

<!-- Main menu template -->
<ng-template #navigationTemplate let-navigation>
    <ul *ngIf="navigation?.length">
        <li *ngFor="let item of navigation" [class.hasMenu]="item.children?.length">
            <a [routerLink]="item.link" matRipple>{{ item.display }}</a>
            <ng-container *ngTemplateOutlet="navigationTemplate; context:{ $implicit: item.children }"></ng-container>
        </li>
    </ul>
</ng-template>

<mat-sidenav-container>

    <mat-sidenav #menu [opened]="menuOpened" position="end">

        <!-- menu mobile -->
        <div id="mobile-menu">
            <ng-container *ngTemplateOutlet="mobileNavigationTemplate; context:{ $implicit: mobileNavigation }"></ng-container>
        </div>
    </mat-sidenav>

    <mat-sidenav-content>

        <mat-toolbar fxHide.gt-sm id="header-mobile" fxLayout="row" fxLayoutAlign="start center">

            <div fxFlex></div>

            <a routerLink="/">
                <img alt="logo" src="assets/logo.png" height="30" />
            </a>

            <div fxFlex></div>

            <button (click)="menu.toggle()" mat-icon-button>
                <natural-icon name="menu"></natural-icon>
            </button>

        </mat-toolbar>

        <div fxHide.lt-md id="header">

            <!-- header : 1s line -->
            <div id="header-top">
                <div class="container" fxLayout="row">
                    <div fxFlex></div>
                    <a mat-button [matMenuTriggerFor]="deviseMenu">
                        {{ currencyService.current.value === Currency.CHF ? 'Suisse (CHF)' : 'Europe (EUR)' }}
                    </a>
                    <mat-menu #deviseMenu="matMenu">
                        <button mat-menu-item (click)="currencyService.setCurrency(Currency.CHF)">Suisse (CHF)</button>
                        <button mat-menu-item (click)="currencyService.setCurrency(Currency.EUR)">Europe (EUR)</button>
                    </mat-menu>
                    <a mat-button *ngFor="let item of topNavigation" [routerLink]="item.link"> {{ item.display }}</a>
                </div>
            </div>

            <!-- header : 2nd line -->
            <div id="header-middle">
                <div class="container" fxLayout="row">
                    <a routerLink="/">
                        <img alt="logo" src="assets/logo.png" height="55" />
                    </a>
                </div>
            </div>

            <!-- header : 3rd line -->
            <div id="header-bottom">
                <div id="menu-main-container" class="container" fxLayout="row" fxLayoutAlign="start end">

                    <div id="menu-main" fxFlex>
                        <ng-container *ngTemplateOutlet="navigationTemplate; context:{ $implicit: navigation }"></ng-container>
                    </div>

                    <mat-form-field id="search-field">
                        <mat-label>Rechercher</mat-label>
                        <input matInput (keydown.enter)="search()" (keydown.esc)="searchTerm = ''" [(ngModel)]="searchTerm">
                        <button matSuffix (click)="search()" mat-icon-button>
                            <natural-icon name="search"></natural-icon>
                        </button>
                    </mat-form-field>
                </div>
            </div>
        </div>

        <!-- THE BODY IS HERE -->
        <div id="front-end-body">
            <router-outlet></router-outlet>
        </div>

        <div id="footer">
            <div class="container" fxLayout="column" fxLayoutGap.gt-sm="60px">

                <div>
                    <div class="mat-display-3">ArtisansDeLa<strong>Transition</strong></div>

                    <div fxLayout="row" fxLayoutGap="10px" fxLayoutAlign="start center">
                        <div class="mat-headline">Inscrivez-vous à la lettre d'info !</div>
                        <mat-form-field>
                            <mat-label>Adresse e-mail</mat-label>
                            <input matInput>
                        </mat-form-field>
                        <button mat-stroked-button color="primary">S'incrire</button>
                    </div>
                </div>

                <div fxLayout="column" fxLayout.gt-sm="row" fxLayoutGap.gt-sm="50px" class="mat-subheading-2">

                    <mat-nav-list fxFlex.gt-sm="33">
                        <a mat-list-item routerLink="product">L'association</a>
                        <a mat-list-item routerLink="product-tag">La Revue Durable</a>
                        <a mat-list-item routerLink="product-tag">Agir avec nous</a>
                        <a mat-list-item routerLink="product-tag">Abonnements</a>
                        <a mat-list-item routerLink="product-tag">Faire un don</a>
                    </mat-nav-list>

                    <mat-nav-list fxFlex.gt-sm="33">
                        <a mat-list-item routerLink="product">Livraison</a>
                        <a mat-list-item routerLink="product-tag">Mentions légales</a>
                        <a mat-list-item routerLink="product-tag">Conditions générales de vente</a>
                        <a mat-list-item routerLink="product-tag">Annonceurs</a>
                    </mat-nav-list>

                    <div fxLayout="column" fxLayoutGap="10px" fxFlex.gt-sm="33">
                        <div>
                            <div class="mat-title no-margin-bottom">Association Artisans de la transition</div>
                            <div class="mat-title"> La Revue durable</div>
                        </div>
                        <div>
                            Rue de Lausanne 23
                            <br />
                            1700 Fribourg
                            <br />
                            Suisse
                            <br />
                            Tél: ...
                        </div>

                    </div>

                </div>
            </div>
        </div>

    </mat-sidenav-content>

</mat-sidenav-container>
