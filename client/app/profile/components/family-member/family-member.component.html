<div *ngIf="form" [formGroup]="form">

    <div fxLayout="column">

        <app-select-enum enumName="Relationship"
                         formControlName="familyRelationship"
                         (selectionChange)="update()"
                         placeholder="Rôle dans la famille"
        ></app-select-enum>

        <mat-form-field>
            <mat-label>Prénom</mat-label>
            <input matInput formControlName="firstName" (change)="update()">
            <mat-error *ngIf="form.get('firstName').hasError('maxlength')">
                Maximum {{form.get('firstName').errors.maxlength.requiredLength}} caractères
            </mat-error>
            <mat-error *ngIf="form.get('firstName').hasError('required')">Requis</mat-error>
        </mat-form-field>

        <mat-form-field>
            <mat-label>Nom de famille</mat-label>
            <input matInput formControlName="lastName" (change)="update()">
            <mat-error *ngIf="form.get('lastName').hasError('maxlength')">
                Maximum {{form.get('lastName').errors.maxlength.requiredLength}} caractères
            </mat-error>
            <mat-error *ngIf="form.get('lastName').hasError('required')">Requis</mat-error>
        </mat-form-field>

        <app-select-enum enumName="Sex" formControlName="sex" (selectionChange)="update()" placeholder="Genre"></app-select-enum>

        <app-address [form]="form" [vertical]="true" (change)="update()"></app-address>

        <mat-form-field fxFlex>
            <mat-label>Téléphone fixe</mat-label>
            <input matInput formControlName="phone" (change)="update()">
        </mat-form-field>

        <mat-form-field fxFlex>
            <mat-label>Téléphone mobile</mat-label>
            <input matInput formControlName="mobilePhone" (change)="update()">
        </mat-form-field>

    </div>

    <mat-divider class="margin-bottom"></mat-divider>

    <div fxLayout="column">

        <mat-form-field fxFlex>
            <mat-label>email</mat-label>
            <input matInput formControlName="email" (change)="update()">
            <app-icon matPrefix name="alternate_email"></app-icon>
            <mat-error *ngIf="form.get('email').hasError('required')">Requis</mat-error>
        </mat-form-field>

        <mat-form-field fxFlex>
            <mat-label>Nom d'utilisateur</mat-label>
            <input matInput formControlName="login" (change)="update()">
            <app-icon matPrefix name="person"></app-icon>
            <mat-error *ngIf="form.get('login').hasError('maxlength')">
                Maximum {{form.get('login').errors.maxlength.requiredLength}} caractères
            </mat-error>
            <mat-error *ngIf="form.get('login').hasError('required')">Requis</mat-error>
            <mat-error *ngIf="form.get('login').hasError('invalid')">{{ form.get('login').getError('invalid') }}</mat-error>
        </mat-form-field>

        <!-- TODO : Implement click event -->
        <button mat-button color="primary" *ngIf="data.model.id" (click)="null">Demander un nouveau mot de passe</button>
    </div>

    <button mat-raised-button *ngIf="!data.model.id" (click)="create.emit()" [color]="form.invalid ? 'warn' : 'accent'"
    >Créer
    </button>

</div>
