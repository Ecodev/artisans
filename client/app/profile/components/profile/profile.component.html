<div fxLayout="column"
     fxLayout.gt-sm="row"
     fxLayoutAlign.gt-sm="start stretch"
     fxLayoutGap="30px"
     [style.padding.px]="30"
     [formGroup]="form"
     fxFlex
>

    <div fxFlex="none" fxFlex.gt-sm="66" fxLayout="column" fxLayoutGap="30px" overflow>

        <div>
            <h2 class="mat-headline">Solde</h2>
            <p>Donec id elit non mi porta gravida at eget metus. Maecenas sed diam eget risus varius blandit sit amet non magna. Morbi leo
               risus, porta ac consectetur ac, vestibulum at eros. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur
               ridiculus mus. Donec ullamcorper nulla non metus auctor fringilla. Fusce dapibus, tellus ac cursus commodo, tortor mauris
               condimentum nibh, ut fermentum massa justo sit amet risus. Donec sed odio dui.</p>

            <mat-form-field>
                <mat-label>IBAN</mat-label>
                <input matInput formControlName="iban" (change)="updateOrCreateAccount()">
                <button mat-icon-button matSuffix (click)="unlockIBAN()" *ngIf="form.get('iban').disabled">
                    <app-icon  name="lock"></app-icon>
                </button>
            </mat-form-field>

        </div>

        <div>
            <h2 class="mat-headline">Cotisation</h2>

            <table mat-table *ngIf="runningServicesDS" [dataSource]="runningServicesDS">
                <tr mat-header-row *matHeaderRowDef="servicesColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: servicesColumns;"></tr>
                <tr mat-footer-row *matFooterRowDef="servicesColumns"></tr>

                <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Nom</th>
                    <td mat-cell *matCellDef="let booking">{{ booking.bookables[0].name }}</td>
                    <td mat-footer-cell *matFooterCellDef> Totaux</td>
                </ng-container>

                <ng-container matColumnDef="periodicPrice">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header app-7em-column>Prix périodique</th>
                    <td mat-cell *matCellDef="let booking">
                        <span *ngIf="booking.bookables[0].periodicPrice"> {{ booking.bookables[0].periodicPrice }} CHF</span>
                    </td>
                    <td mat-footer-cell *matFooterCellDef> {{ totalPeriodic }} CHF</td>
                </ng-container>

                <ng-container matColumnDef="initialPrice">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header app-7em-column>Prix initial</th>
                    <td mat-cell *matCellDef="let booking">
                        <span *ngIf="booking.bookables[0].initialPrice"> {{ booking.bookables[0].initialPrice }} CHF</span>
                    </td>
                    <td mat-footer-cell *matFooterCellDef> {{ totalInitial }} CHF</td>
                </ng-container>

                <ng-container matColumnDef="revoke">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header app-1em-column></th>
                    <td mat-cell *matCellDef="let booking">
                        <button mat-icon-button color="warn" (click)="revokeBooking(booking)" *ngIf="canRevoke(booking)">
                            <app-icon name="delete"></app-icon>
                        </button>
                    </td>
                    <td mat-footer-cell *matFooterCellDef></td>
                </ng-container>

            </table>
        </div>

        <div fxLayout="column" fxLayoutGap="10px">
            <h2 class="mat-headline">Demandes en attente</h2>
            <table mat-table *ngIf="runningServicesDS" [dataSource]="pendingApplicationsDS">
                <tr mat-header-row *matHeaderRowDef="applicationsColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: applicationsColumns;"></tr>
                <tr mat-footer-row *matFooterRowDef="applicationsColumns"></tr>

                <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Nom</th>
                    <td mat-cell *matCellDef="let booking">{{ booking.bookables[0].name }}</td>
                    <td mat-footer-cell *matFooterCellDef> Totaux</td>
                </ng-container>

                <ng-container matColumnDef="periodicPrice">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header app-7em-column>Prix périodique</th>
                    <td mat-cell *matCellDef="let booking">
                        <span *ngIf="booking.bookables[0].periodicPrice"> {{ booking.bookables[0].periodicPrice }} CHF</span>
                    </td>
                    <td mat-footer-cell *matFooterCellDef> {{ totalPeriodic }} CHF</td>
                </ng-container>

                <ng-container matColumnDef="initialPrice">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header app-7em-column>Prix initial</th>
                    <td mat-cell *matCellDef="let booking">
                        <span *ngIf="booking.bookables[0].initialPrice"> {{ booking.bookables[0].initialPrice }} CHF</span>
                    </td>
                    <td mat-footer-cell *matFooterCellDef> {{ totalInitial }} CHF</td>
                </ng-container>

                <ng-container matColumnDef="cancel">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header app-1em-column></th>
                    <td mat-cell *matCellDef="let booking">
                        <button mat-icon-button color="warn" (click)="cancelApplication(booking)">
                            <app-icon name="delete"></app-icon>
                        </button>
                    </td>
                    <td mat-footer-cell *matFooterCellDef></td>
                </ng-container>
            </table>
            <app-select [service]="bookableService"
                        [filter]="BookableService.adminApproved.filter"
                        (selectionChange)="addApplication($event)"
                        placeholder="Demander un espace de stockage"
            ></app-select>
        </div>

    </div>

    <div fxFlex="none" fxFlex.gt-sm="33" fxLayout="column">
        <h2 class="mat-headline">Famille</h2>
        <app-family *ngIf="!data.model.responsible" [responsible]="data.model" fxFlex fxLayout="column"></app-family>
    </div>

</div>
